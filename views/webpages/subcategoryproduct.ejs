<%- include('../../public/assets/include/header'); %>
<section class="inner-wrapper white-inner-wrapper">
    <div class="container">
       <div class="title-box">       
             <h1>All Products</h1> 
          <div class="breadcum-product">
             <ul>
                 
                <li><a href="javascript:void(0)">Home</a></li>               
                <li>All Products</li>
             </ul>
          </div>        
         </div>
       <div class="product-wrapper">         
          <div class="main_product-wrapper fullwidth-productlist">
              <div class="top-title shorting-row">
          <div class="product-result d-flex aling-center">
             <h5></h5>
          </div>
          <div class="shorting-box">
            <div class="short-label">Sort by:</div>
            <div class="short-dropdown">
               <select class="form-control sortBy" id="sortBy" name="sortBy">
                  <option>Choose</option>
                  <option value="0">Low - High</option>
                  <option value="1">High - Low</option>
             </select>
            </div>
          </div>
       </div>
       <div class="product-listrow column4-box sortdata" >
          <% if (respdata && respdata.length > 0) { %>
          <% respdata.forEach(function(item) { %>
            
          <div class="product-box">
            
            <div class="product-image">
                
               
                    <a href="/api/productdeatils/<%=item._id%>"><img src="<%=item.product_images[0].image%>" alt="images" class="img-fluid"></a>
               
            </div>
            
            <div class="prd-short-info">
               <div class="prd-name"><a href="/api/productdeatils/<%=item._id%>"><%=item.name%></a></div>
               <div class="prd-price"><span><i class="fa fa-inr" aria-hidden="true"></i></span><%=item.offer_price%></div>
               <div class="rtl-price"><span>Est. Retail:</span><%=item.price%></div>                 
            </div> 
         </div>
         
         <% }); %>
         <% } else { %>
            <p>No products found yet.</p>
          <% } %>
       
        </div>
       
          
    </div>
 </section>

<%- include('../../public/assets/include/newsletter'); %>
<%- include('../../public/assets/include/footer'); %>

<script>
 $(document).on('change', ".sortBy", function(e){
    let categoryId ="<%= product_category_id %>";
    let optionId = $(this).val();

    $.ajax({
        url: `/api/websubcategoriesproductswithsort/${categoryId}/${optionId.trim()}`,
        method: 'GET',
        success: function(data) {
            console.log(data);

            // Update the content of the 'sortdata' div with the received data
            let htmlContent = '';
            if (data && data.respdata && data.respdata.length > 0) {
                data.respdata.forEach(function(item) {
                    htmlContent += `
                        <div class="product-box">
                            <div class="product-image">
                                <a href="/api/productdeatils/${item._id}">
                                    <img src="${item.product_images[0].image}" alt="images" class="img-fluid">
                                </a>
                            </div>
                            <div class="prd-short-info">
                                <div class="prd-name">
                                    <a href="/api/productdeatils/${item._id}">${item.name}</a>
                                </div>
                                <div class="prd-price">
                                    <span><i class="fa fa-inr" aria-hidden="true"></i></span>${item.offer_price}
                                </div>
                                <div class="rtl-price">
                                    <span>Est. Retail:</span>${item.price}
                                </div>                 
                            </div> 
                        </div>`;
                });
            } else {
                htmlContent = '<p>No products found yet.</p>';
            }

            $('.sortdata').html(htmlContent);
        },
        error: function(err) {
            console.error('Error:', err);
        } 
    });
});
 </script>
 